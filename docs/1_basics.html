<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Basic usage &mdash; dustpy  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Simple Customization" href="2_simple_customization.html" />
    <link rel="prev" title="DustPy Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> dustpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Basic usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#The-Simulation-Frame">The Simulation Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Initializing">Initializing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Running-a-Simulation">Running a Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plotting">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Code-Units">Code Units</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Reading-data-files">Reading data files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Reading-Dump-Files">Reading Dump Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="2_simple_customization.html">2. Simple Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_advanced_customization.html">3. Advanced Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_standard_model.html">4. The Standard Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_dust_coagulation.html">5. Dust Coagulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_dust_evolution.html">6. Dust Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_gas_evolution.html">7. Gas Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_analytical_coagulation_kernels.html">Test: Analytical Coagulation Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_gas_evolution.html">Test: Gas Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_ice_lines.html">Example: Ice Lines</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_planetary_gaps.html">Example: Planetary Gaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_planetesimal_formation.html">Example: Planetesimal Formation</a></li>
<li class="toctree-l1"><a class="reference internal" href="A_publications.html">Appendix A: List of Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Module Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dustpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>1. Basic usage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/1_basics.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="1.-Basic-usage">
<h1>1. Basic usage<a class="headerlink" href="#1.-Basic-usage" title="Permalink to this headline"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">DustPy</span></code> is using on the <code class="docutils literal notranslate"><span class="pre">simframe</span></code> framework for running scientific simulations. For a detailed description of the usage of <code class="docutils literal notranslate"><span class="pre">simframe</span></code> please have a look at the <a class="reference external" href="https://simframe.rtfd.io/">Simframe Documentation</a>.</p>
<p>This notebook demonstrates how to run the most simple <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> model, i.e., the model that is run by default, how to plot data, and how to resume simulations from dump files.</p>
<section id="The-Simulation-Frame">
<h2>The Simulation Frame<a class="headerlink" href="#The-Simulation-Frame" title="Permalink to this headline"></a></h2>
<p>To set up a model we have to import the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> class from the <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> package.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dustpy</span> <span class="kn">import</span> <span class="n">Simulation</span>
</pre></div>
</div>
</div>
<p>We can now create an instance of this class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>At this stage <code class="docutils literal notranslate"><span class="pre">sim</span></code> is an empty simulation object that controls our simulation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DustPy
------
    dust         : Group (Dust quantities)
    gas          : Group (Gas quantities)
    grid         : Group (Grid quantities)
    star         : Group (Stellar quantities)
  -----
    t            : NoneType
  -----
    Integrator   : <span class="ansi-yellow-intense-fg">not specified</span>
    Writer       : <span class="ansi-yellow-intense-fg">not specified</span>
</pre></div></div>
</div>
<p>All the fields are initialized with <code class="docutils literal notranslate"><span class="pre">None</span></code>. All attributes can be easiliy addressed via e.g.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Gas quantities)
----------------------
    boundary     : Group (Boundary conditions)
    S            : Group (Source terms)
    v            : Group (Velocities)
  -----
    alpha        : NoneType
    cs           : NoneType
    eta          : NoneType
    Fi           : NoneType
    gamma        : NoneType
    Hp           : NoneType
    mfp          : NoneType
    mu           : NoneType
    n            : NoneType
    nu           : NoneType
    P            : NoneType
    rho          : NoneType
    Sigma        : NoneType
    SigmaFloor   : NoneType
    T            : NoneType
  -----
</pre></div></div>
</div>
</section>
<section id="Initializing">
<h2>Initializing<a class="headerlink" href="#Initializing" title="Permalink to this headline"></a></h2>
<p>We can now initialize the <code class="docutils literal notranslate"><span class="pre">sim</span></code> object with <code class="docutils literal notranslate"><span class="pre">Simulation.initialize()</span></code>. <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> will then fill all the fields with default values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">As you can see, the <code class="docutils literal notranslate"><span class="pre">sim</span></code> object has now values assigned to its fields.</div>
<div class="line"><strong>All quantities are in cgs units.</strong></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Gas quantities)
----------------------
    boundary     : Group (Boundary conditions)
    S            : Group (Source terms)
    v            : Group (Velocities)
  -----
    alpha        : Field (Turbulent alpha parameter)
    cs           : Field (Sound speed [cm/s])
    eta          : Field (Pressure gradient parameter)
    Fi           : Field (Gas flux interfaces [g/cm/s])
    gamma        : Field (Adiabatic index)
    Hp           : Field (Pressure scale height [cm])
    mfp          : Field (Midplane mean free path [cm])
    mu           : Field (Mean molecular weight [g])
    n            : Field (Miplane number density [1/cm³])
    nu           : Field (Kinematic viscosity [cm²/s])
    P            : Field (Midplane pressure [g/cm/s²])
    rho          : Field (Miplane mass density [g/cm³])
    Sigma        : Field (Surface density [g/cm²])
    SigmaFloor   : Field (Floor value of surface density [g/cm²])
    T            : Field (Temperature [K])
  -----
</pre></div></div>
</div>
<p>You can also display the full table of contents of the <code class="docutils literal notranslate"><span class="pre">sim</span></code> object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">toc</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-blue-intense-fg">DustPy</span>
    - <span class="ansi-blue-intense-fg">dust</span>: <span class="ansi-blue-intense-fg">Group (Dust quantities)</span>
        - <span class="ansi-blue-intense-fg">a</span>: Field (Particle size [cm])
        - <span class="ansi-blue-intense-fg">backreaction</span>: <span class="ansi-blue-intense-fg">Group (Backreaction coefficients)</span>
            - <span class="ansi-blue-intense-fg">A</span>: Field (Pull factor)
            - <span class="ansi-blue-intense-fg">B</span>: Field (Push factor)
        - <span class="ansi-blue-intense-fg">boundary</span>: <span class="ansi-blue-intense-fg">Group (Boundary conditions)</span>
            - <span class="ansi-blue-intense-fg">inner</span>: Constant gradient
            - <span class="ansi-blue-intense-fg">outer</span>: Value
        - <span class="ansi-blue-intense-fg">coagulation</span>: <span class="ansi-blue-intense-fg">Group (Coagulation quantities)</span>
            - <span class="ansi-blue-intense-fg">A</span>: Field (Fragment normalization factors), <span class="ansi-magenta-intense-fg">constant</span>
            - <span class="ansi-blue-intense-fg">eps</span>: Field (Remnant mass distribution), <span class="ansi-magenta-intense-fg">constant</span>
            - <span class="ansi-blue-intense-fg">lf_ind</span>: Field (Index of largest fragment), <span class="ansi-magenta-intense-fg">constant</span>
            - <span class="ansi-blue-intense-fg">phi</span>: Field (Fragment distribution), <span class="ansi-magenta-intense-fg">constant</span>
            - <span class="ansi-blue-intense-fg">rm_ind</span>: Field (Smaller index of remnant), <span class="ansi-magenta-intense-fg">constant</span>
            - <span class="ansi-blue-intense-fg">stick</span>: Field (Sticking matrix), <span class="ansi-magenta-intense-fg">constant</span>
            - <span class="ansi-blue-intense-fg">stick_ind</span>: Field (Non-zero elements of sticking matrix), <span class="ansi-magenta-intense-fg">constant</span>
        - <span class="ansi-blue-intense-fg">D</span>: Field (Diffusivity [cm²/s])
        - <span class="ansi-blue-intense-fg">delta</span>: <span class="ansi-blue-intense-fg">Group (Mixing parameters)</span>
            - <span class="ansi-blue-intense-fg">rad</span>: Field (Radial mixing parameter)
            - <span class="ansi-blue-intense-fg">turb</span>: Field (Turbulent mixing parameter)
            - <span class="ansi-blue-intense-fg">vert</span>: Field (Vertical mixing parameter)
        - <span class="ansi-blue-intense-fg">eps</span>: Field (Dust-to-gas ratio)
        - <span class="ansi-blue-intense-fg">Fi</span>: <span class="ansi-blue-intense-fg">Group (Fluxes)</span>
            - <span class="ansi-blue-intense-fg">adv</span>: Field (Advective flux [g/cm/s])
            - <span class="ansi-blue-intense-fg">diff</span>: Field (Diffusive flux [g/cm/s])
            - <span class="ansi-blue-intense-fg">tot</span>: Field (Total flux [g/cm/s])
        - <span class="ansi-blue-intense-fg">fill</span>: Field (Filling factor)
        - <span class="ansi-blue-intense-fg">H</span>: Field (Scale heights [cm])
        - <span class="ansi-blue-intense-fg">kernel</span>: Field (Collision kernel [cm²/s])
        - <span class="ansi-blue-intense-fg">p</span>: <span class="ansi-blue-intense-fg">Group (Probabilities)</span>
            - <span class="ansi-blue-intense-fg">frag</span>: Field (Fragmentation probability)
            - <span class="ansi-blue-intense-fg">stick</span>: Field (Sticking probability)
        - <span class="ansi-blue-intense-fg">rho</span>: Field (Midplane mass density per mass bin [g/cm³])
        - <span class="ansi-blue-intense-fg">rhos</span>: Field (Solid state density [g/cm³])
        - <span class="ansi-blue-intense-fg">S</span>: <span class="ansi-blue-intense-fg">Group (Sources)</span>
            - <span class="ansi-blue-intense-fg">coag</span>: Field (Coagulation sources [g/cm²/s])
            - <span class="ansi-blue-intense-fg">ext</span>: Field (External sources [g/cm²/s])
            - <span class="ansi-blue-intense-fg">hyd</span>: Field (Hydrodynamic sources [g/cm²/s])
            - <span class="ansi-blue-intense-fg">tot</span>: Field (Tot sources [g/cm²/s])
        - <span class="ansi-blue-intense-fg">Sigma</span>: Field (Surface density per mass bin [g/cm²])
        - <span class="ansi-blue-intense-fg">SigmaFloor</span>: Field (Floor value of surface density [g/cm²])
        - <span class="ansi-blue-intense-fg">St</span>: Field (Stokes number)
        - <span class="ansi-blue-intense-fg">v</span>: <span class="ansi-blue-intense-fg">Group (Velocities)</span>
            - <span class="ansi-blue-intense-fg">driftmax</span>: Field (Maximum drift velocity [cm/s])
            - <span class="ansi-blue-intense-fg">frag</span>: Field (Fragmentation velocity [cm/s])
            - <span class="ansi-blue-intense-fg">rad</span>: Field (Radial velocity [cm/s])
            - <span class="ansi-blue-intense-fg">rel</span>: <span class="ansi-blue-intense-fg">Group (Relative velocities)</span>
                - <span class="ansi-blue-intense-fg">azi</span>: Field (Relative azimuthal velocity [cm/s])
                - <span class="ansi-blue-intense-fg">brown</span>: Field (Relative Brownian motion velocity [cm/s])
                - <span class="ansi-blue-intense-fg">rad</span>: Field (Relative radial velocity [cm/s])
                - <span class="ansi-blue-intense-fg">tot</span>: Field (Total relative velocity [cm/s])
                - <span class="ansi-blue-intense-fg">turb</span>: Field (Relative turbulent velocity [cm/s])
                - <span class="ansi-blue-intense-fg">vert</span>: Field (Relative vertical settling velocity [cm/s])
    - <span class="ansi-blue-intense-fg">gas</span>: <span class="ansi-blue-intense-fg">Group (Gas quantities)</span>
        - <span class="ansi-blue-intense-fg">alpha</span>: Field (Turbulent alpha parameter)
        - <span class="ansi-blue-intense-fg">boundary</span>: <span class="ansi-blue-intense-fg">Group (Boundary conditions)</span>
            - <span class="ansi-blue-intense-fg">inner</span>: Constant gradient
            - <span class="ansi-blue-intense-fg">outer</span>: Value
        - <span class="ansi-blue-intense-fg">cs</span>: Field (Sound speed [cm/s])
        - <span class="ansi-blue-intense-fg">eta</span>: Field (Pressure gradient parameter)
        - <span class="ansi-blue-intense-fg">Fi</span>: Field (Gas flux interfaces [g/cm/s])
        - <span class="ansi-blue-intense-fg">gamma</span>: Field (Adiabatic index)
        - <span class="ansi-blue-intense-fg">Hp</span>: Field (Pressure scale height [cm])
        - <span class="ansi-blue-intense-fg">mfp</span>: Field (Midplane mean free path [cm])
        - <span class="ansi-blue-intense-fg">mu</span>: Field (Mean molecular weight [g])
        - <span class="ansi-blue-intense-fg">n</span>: Field (Miplane number density [1/cm³])
        - <span class="ansi-blue-intense-fg">nu</span>: Field (Kinematic viscosity [cm²/s])
        - <span class="ansi-blue-intense-fg">P</span>: Field (Midplane pressure [g/cm/s²])
        - <span class="ansi-blue-intense-fg">rho</span>: Field (Miplane mass density [g/cm³])
        - <span class="ansi-blue-intense-fg">S</span>: <span class="ansi-blue-intense-fg">Group (Source terms)</span>
            - <span class="ansi-blue-intense-fg">ext</span>: Field (External sources [g/cm²/s])
            - <span class="ansi-blue-intense-fg">hyd</span>: Field (Hydrodynamic sources [g/cm²/s])
            - <span class="ansi-blue-intense-fg">tot</span>: Field (Total sources [g/cm²/s])
        - <span class="ansi-blue-intense-fg">Sigma</span>: Field (Surface density [g/cm²])
        - <span class="ansi-blue-intense-fg">SigmaFloor</span>: Field (Floor value of surface density [g/cm²])
        - <span class="ansi-blue-intense-fg">T</span>: Field (Temperature [K])
        - <span class="ansi-blue-intense-fg">v</span>: <span class="ansi-blue-intense-fg">Group (Velocities)</span>
            - <span class="ansi-blue-intense-fg">rad</span>: Field (Radial velocity [cm/s])
            - <span class="ansi-blue-intense-fg">visc</span>: Field (Viscous accretion velocity [cm/s])
    - <span class="ansi-blue-intense-fg">grid</span>: <span class="ansi-blue-intense-fg">Group (Grid quantities)</span>
        - <span class="ansi-blue-intense-fg">A</span>: Field (Radial grid annulus area [cm²]), <span class="ansi-magenta-intense-fg">constant</span>
        - <span class="ansi-blue-intense-fg">m</span>: Field (Mass grid [g]), <span class="ansi-magenta-intense-fg">constant</span>
        - <span class="ansi-blue-intense-fg">Nm</span>: Field (# of mass bins), <span class="ansi-magenta-intense-fg">constant</span>
        - <span class="ansi-blue-intense-fg">Nr</span>: Field (# of radial grid cells), <span class="ansi-magenta-intense-fg">constant</span>
        - <span class="ansi-blue-intense-fg">OmegaK</span>: Field (Keplerian frequency [1/s])
        - <span class="ansi-blue-intense-fg">r</span>: Field (Radial grid cell centers [cm]), <span class="ansi-magenta-intense-fg">constant</span>
        - <span class="ansi-blue-intense-fg">ri</span>: Field (Radial grid cell interfaces [cm]), <span class="ansi-magenta-intense-fg">constant</span>
    - <span class="ansi-blue-intense-fg">star</span>: <span class="ansi-blue-intense-fg">Group (Stellar quantities)</span>
        - <span class="ansi-blue-intense-fg">L</span>: Field (Luminosity [erg/s])
        - <span class="ansi-blue-intense-fg">M</span>: Field (Mass [g])
        - <span class="ansi-blue-intense-fg">R</span>: Field (Radius [cm])
        - <span class="ansi-blue-intense-fg">T</span>: Field (Effective temperature [K])
    - <span class="ansi-blue-intense-fg">t</span>: IntVar (Time [s]), <span class="ansi-magenta-intense-fg">Integration variable</span>
</pre></div></div>
</div>
</section>
<section id="Running-a-Simulation">
<h2>Running a Simulation<a class="headerlink" href="#Running-a-Simulation" title="Permalink to this headline"></a></h2>
<p>The simulation is now ready to go. This will take a few minutes. The default simulation is running for 100,000 years.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

DustPy v1.0.0

Documentation: https://stammler.github.io/dustpy/
PyPI:          https://pypi.org/project/dustpy/
GitHub:        https://github.com/stammler/dustpy/

<span class="ansi-yellow-intense-fg">Checking for mass conservation...
</span>
<span class="ansi-yellow-intense-fg">    - Sticking:</span>
        max. rel. error: <span class="ansi-green-intense-fg"> 2.81e-14</span>
        for particle collision
            m[114] =  1.93e+04 g    with
            m[116] =  3.73e+04 g
<span class="ansi-yellow-intense-fg">    - Full fragmentation:</span>
        max. rel. error: <span class="ansi-green-intense-fg"> 4.44e-16</span>
        for particle collision
            m[47] =  5.18e-06 g    with
            m[54] =  5.18e-05 g
<span class="ansi-yellow-intense-fg">    - Erosion:</span>
        max. rel. error: <span class="ansi-green-intense-fg"> 1.78e-15</span>
        for particle collision
            m[110] =  5.18e+03 g    with
            m[118] =  7.20e+04 g

Creating data directory &#39;data&#39;.
Writing file <span class="ansi-blue-intense-fg">data/data0000.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0001.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0002.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0003.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0004.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0005.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0006.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0007.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0008.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0009.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0010.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0011.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0012.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0013.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0014.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0015.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0016.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0017.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0018.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0019.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0020.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Writing file <span class="ansi-blue-intense-fg">data/data0021.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Execution time: <span class="ansi-blue-intense-fg">0:23:05</span>
</pre></div></div>
</div>
<p>By default <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> has written output files into the <code class="docutils literal notranslate"><span class="pre">data/</span></code> directory.</p>
</section>
<section id="Plotting">
<h2>Plotting<a class="headerlink" href="#Plotting" title="Permalink to this headline"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">DustPy</span></code> is coming with a simple plotting script that can be used to check the status of a simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dustpy</span> <span class="kn">import</span> <span class="n">plot</span>
</pre></div>
</div>
</div>
<p>The plotting script does either take the simulation object as argument or a data directory.</p>
<p>If the argument is a simulation object the script is only plotting the current state.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/1_basics_21_0.png" src="_images/1_basics_21_0.png" />
</div>
</div>
<p>The blue and the green lines in the top left panel are analytical estimates for the fragmentation and drift barrier taken from <a class="reference external" href="https://doi.org/10.1051/0004-6361/201118136">Birnstiel et al. (2012)</a>.</p>
<div class="line-block">
<div class="line">If you pass the data directory as argument, you also have access to the time evolution.</div>
<div class="line">Furthermore, some plots can be addressed by specifying the time <code class="docutils literal notranslate"><span class="pre">it</span></code>, radial <code class="docutils literal notranslate"><span class="pre">ir</span></code>, or mass <code class="docutils literal notranslate"><span class="pre">im</span></code> index.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">it</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ir</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">im</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/1_basics_23_0.png" src="_images/1_basics_23_0.png" />
</div>
</div>
<p>The top middle and bottom left panels show the dust density distribution along the gray dashed lines in the top left panel.</p>
<p>It’s furthermore possible to use an interactive plotting script.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">ipanel</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/1_basics_26_0.png" src="_images/1_basics_26_0.png" />
</div>
</div>
<section id="Code-Units">
<h3>Code Units<a class="headerlink" href="#Code-Units" title="Permalink to this headline"></a></h3>
<p>The dust density distribution plotted here is given by</p>
<p><span class="math notranslate nohighlight">\(\Sigma_\mathrm{d} \left( r \right) = \int\limits_0^\infty \sigma \left(r, m \right) \mathrm{d} \log m\)</span>.</p>
<p>In this way the distribution is independent of the mass grid.</p>
<p>The code units <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> uses are <span class="math notranslate nohighlight">\(\Sigma_{\mathrm{d},\,i} \left( r \right) \equiv \Sigma_\mathrm{d} \left(r, m_i \right)\)</span> with</p>
<p><span class="math notranslate nohighlight">\(\Sigma_\mathrm{d} \left( r \right) = \sum\limits_i \Sigma_{\mathrm{d},\,i} \left( r \right)\)</span>,</p>
<p>meaning the numerical sum over the mass dimension is the dust surface density.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.09283251e+01 1.01828791e+01 9.48604209e+00 8.84125739e+00
 8.23867056e+00 7.67572175e+00 7.14975349e+00 6.65848859e+00
 6.19983596e+00 5.77157157e+00 5.37175385e+00 4.99865770e+00
 4.65045291e+00 4.32549793e+00 4.02237960e+00 3.73959690e+00
 3.47577340e+00 3.22975789e+00 3.00032001e+00 2.78631745e+00
 2.58681571e+00 2.40080359e+00 2.22734626e+00 2.06568645e+00
 1.91498800e+00 1.77449952e+00 1.64360690e+00 1.52161226e+00
 1.40792466e+00 1.30204415e+00 1.20338092e+00 1.11148613e+00
 1.02595994e+00 9.46276407e-01 8.72117309e-01 8.03117313e-01
 7.38886732e-01 6.79161103e-01 6.23609854e-01 5.71969659e-01
 5.24020648e-01 4.79450218e-01 4.38089587e-01 3.99708279e-01
 3.64124176e-01 3.31163854e-01 3.00633873e-01 2.72409689e-01
 2.46311654e-01 2.22232778e-01 2.00023579e-01 1.79584810e-01
 1.60790114e-01 1.43549100e-01 1.27752412e-01 1.13321095e-01
 1.00156097e-01 8.81859049e-02 7.73227535e-02 6.74980729e-02
 5.86505281e-02 5.07106051e-02 4.36281124e-02 3.73581134e-02
 3.18329644e-02 2.69787714e-02 2.27219610e-02 1.89982012e-02
 1.57554731e-02 1.29506015e-02 1.05449053e-02 8.49993421e-03
 6.77493496e-03 5.31979676e-03 4.06409721e-03 2.91135019e-03
 1.79361374e-03 8.21886626e-04 2.63785626e-04 5.76729804e-05
 8.54700359e-06 9.39124924e-07 7.84498062e-08 5.04238982e-09
 2.49642874e-10 9.41564487e-12 2.63750869e-13 5.26021058e-15
 7.03575698e-17 5.86092099e-19 2.80747056e-21 7.20204157e-24
 9.55246943e-27 9.61065004e-29 7.84604554e-29 6.83347700e-29
 5.95170965e-29 5.18372240e-29 4.51483347e-29 3.93225557e-29]
</pre></div></div>
</div>
<p>To convert this into <span class="math notranslate nohighlight">\(\sigma\)</span> we have to divide the code density distribution by <span class="math notranslate nohighlight">\(B = \frac{\Delta m}{m}\)</span>, where <span class="math notranslate nohighlight">\(\Delta m\)</span> is the width of the mass bin centered on <span class="math notranslate nohighlight">\(m\)</span>.</p>
<p>Since the mass grid is strictly logarithmic the following relation holds</p>
<p><span class="math notranslate nohighlight">\(m_{i+1} = A \cdot m_i\)</span>.</p>
<p>The grid constant <span class="math notranslate nohighlight">\(A\)</span> can be easily calculated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">/</span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">m</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.3894954943731377
</pre></div></div>
</div>
<p>We further assume that the mass bin center is exactly in the middle between the mass bin interfaces</p>
<p><span class="math notranslate nohighlight">\(m_i = \frac{1}{2} \left( m_{i-\frac{1}{2}} + m_{i+\frac{1}{2}} \right)\)</span>.</p>
<p>Solving for the interfaces yields</p>
<p><span class="math notranslate nohighlight">\(\begin{split} m_{i-\frac{1}{2}} &amp;= \frac{2}{A+1} m_i \\ m_{i+\frac{1}{2}} &amp;= \frac{2}{A+1} A\cdot m_i. \end{split}\)</span></p>
<p>We therefore have</p>
<p><span class="math notranslate nohighlight">\(\Delta m_i = m_{i+\frac{1}{2}} - m_{i-\frac{1}{2}} = 2\frac{A-1}{A+1}m_i\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(B = \frac{\Delta m_i}{m_i} = 2\frac{A-1}{A+1}\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">/</span> <span class="n">B</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1.30710743e-01 1.11917741e-01 1.23759508e-01 ... 1.52526930e-23
  2.11935481e-23 2.94483396e-23]
 [1.25016332e-01 1.06694179e-01 1.17672100e-01 ... 1.32845402e-23
  1.84588088e-23 2.56484316e-23]
 [1.19918699e-01 1.01979933e-01 1.12146412e-01 ... 1.15703508e-23
  1.60769503e-23 2.23388501e-23]
 ...
 [4.45718657e-46 6.19324066e-46 8.60547999e-46 ... 2.30858850e-29
  3.20777332e-29 4.45718657e-29]
 [3.88204722e-46 5.39408712e-46 7.49505975e-46 ... 2.01069653e-29
  2.79385376e-29 3.88204722e-29]
 [3.38112178e-46 4.69805348e-46 6.52792414e-46 ... 1.75124347e-29
  2.43334490e-29 3.38112178e-29]]
</pre></div></div>
</div>
</section>
</section>
<section id="Reading-data-files">
<h2>Reading data files<a class="headerlink" href="#Reading-data-files" title="Permalink to this headline"></a></h2>
<p>If you want to read data files you can use the read/writer module provided by <code class="docutils literal notranslate"><span class="pre">simframe</span></code>, that is used to write the data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dustpy</span> <span class="kn">import</span> <span class="n">hdf5writer</span>

<span class="n">wrtr</span> <span class="o">=</span> <span class="n">hdf5writer</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Make sure that the correct data directory is assigned to the writer.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wrtr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writer (HDF5 file format using h5py)
------------------------------------
    Data directory : data
    File names     : data/data0000.hdf5
    Overwrite      : False
    Dumping        : True
    Options        : {&#39;com&#39;: &#39;lzf&#39;, &#39;comopts&#39;: None}
    Verbosity      : 1
</pre></div></div>
</div>
<p>You can now read a single data file with</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data0003</span> <span class="o">=</span> <span class="n">wrtr</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This function returns a namespace and the data can simply be accessed in the same way as for the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data0003</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">Sigma</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1.11397571e+003, 1.03910595e+003, 9.69196471e+002, 9.03718193e+002,
       8.42430438e+002, 7.85106260e+002, 7.31526211e+002, 6.81474748e+002,
       6.34739640e+002, 5.91113562e+002, 5.50396527e+002, 5.12398007e+002,
       4.76938187e+002, 4.43848361e+002, 4.12970747e+002, 3.84157989e+002,
       3.57272545e+002, 3.32186063e+002, 3.08778773e+002, 2.86938915e+002,
       2.66562214e+002, 2.47551371e+002, 2.29815605e+002, 2.13270219e+002,
       1.97836192e+002, 1.83439801e+002, 1.70012273e+002, 1.57489450e+002,
       1.45811487e+002, 1.34922560e+002, 1.24770602e+002, 1.15307053e+002,
       1.06486625e+002, 9.82670833e+001, 9.06090451e+001, 8.34757883e+001,
       7.68330738e+001, 7.06489789e+001, 6.48937424e+001, 5.95396186e+001,
       5.45607415e+001, 4.99329969e+001, 4.56339029e+001, 4.16424973e+001,
       3.79392329e+001, 3.45058773e+001, 3.13254204e+001, 2.83819862e+001,
       2.56607498e+001, 2.31478592e+001, 2.08303612e+001, 1.86961317e+001,
       1.67338094e+001, 1.49327331e+001, 1.32828828e+001, 1.17748238e+001,
       1.03996542e+001, 9.14895562e+000, 8.01474777e+000, 6.98944552e+000,
       6.06582038e+000, 5.23696536e+000, 4.49626392e+000, 3.83736305e+000,
       3.25415082e+000, 2.74073848e+000, 2.29144739e+000, 1.90080069e+000,
       1.56351980e+000, 1.27452557e+000, 1.02894369e+000, 8.22113973e-001,
       6.49602648e-001, 5.07217032e-001, 3.91021309e-001, 2.97352370e-001,
       2.22834415e-001, 1.64391041e-001, 1.19253644e-001, 8.49650977e-002,
       5.93779592e-002, 4.06467827e-002, 2.72145282e-002, 1.77934744e-002,
       1.13414447e-002, 7.03450119e-003, 4.23748972e-003, 2.47392774e-003,
       1.39667732e-003, 7.60666143e-004, 3.98625240e-004, 2.00452834e-004,
       9.64394775e-005, 4.42506586e-005, 1.92990443e-005, 7.97125911e-006,
       3.10602166e-006, 1.13699106e-006, 3.88105640e-007, 1.00000000e-100])
</pre></div></div>
</div>
<p>You can also read the full data directory with</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">wrtr</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The data has now an additional dimension for time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(22, 100)
</pre></div></div>
</div>
<p>Data files can be quite large and reading the entire data set can take some time. Is is also possible to only read a single field from the data files instead of the entire data set.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SigmaGas</span> <span class="o">=</span> <span class="n">wrtr</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="s2">&quot;gas.Sigma&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SigmaGas</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(22, 100)
</pre></div></div>
</div>
<p>It is also possible to exclude certain fields from being written into the data files to save memory by setting their <code class="docutils literal notranslate"><span class="pre">save</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</section>
<section id="Reading-Dump-Files">
<h2>Reading Dump Files<a class="headerlink" href="#Reading-Dump-Files" title="Permalink to this headline"></a></h2>
<p>The data files are only containing the pure data, but no information about the operations <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> has to perform, like customized functions. Therefore, it’s not possible to directly restart a simulation from data files.</p>
<p><code class="docutils literal notranslate"><span class="pre">simframe</span></code> is saving by default the most recent dump file, from which a simulation can be restarted.</p>
<p><strong>Attention:</strong> Malware can be injected with dump files, which are pickled objects. Only read dump files that you have created yourself or from sources that you trust! Dump files have to be read with the same version of <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> as they were written. Otherwise, it is not guaranteed to work.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dustpy</span> <span class="kn">import</span> <span class="n">readdump</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_restart</span> <span class="o">=</span> <span class="n">readdump</span><span class="p">(</span><span class="s2">&quot;data/frame.dmp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This is now a simulation frame that should be identical to our previous object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">==</span> <span class="n">sim_restart</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">Sigma</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True]
</pre></div></div>
</div>
<p>We can now, for example, add more snapshots and restart the simulation. Here we just want to extend the run by one year.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dustpy</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">c</span>

<span class="n">sim_restart</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">snapshots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sim_restart</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="p">[</span><span class="mf">100001.</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">year</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>The current time is</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_restart</span><span class="o">.</span><span class="n">t</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100000.0
</pre></div></div>
</div>
<p>We can now restart the simulation for another year.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_restart</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

DustPy v1.0.0

Documentation: https://stammler.github.io/dustpy/
PyPI:          https://pypi.org/project/dustpy/
GitHub:        https://github.com/stammler/dustpy/

<span class="ansi-yellow-intense-fg">Checking for mass conservation...
</span>
<span class="ansi-yellow-intense-fg">    - Sticking:</span>
        max. rel. error: <span class="ansi-green-intense-fg"> 2.81e-14</span>
        for particle collision
            m[114] =  1.93e+04 g    with
            m[116] =  3.73e+04 g
<span class="ansi-yellow-intense-fg">    - Full fragmentation:</span>
        max. rel. error: <span class="ansi-green-intense-fg"> 4.44e-16</span>
        for particle collision
            m[47] =  5.18e-06 g    with
            m[54] =  5.18e-05 g
<span class="ansi-yellow-intense-fg">    - Erosion:</span>
        max. rel. error: <span class="ansi-green-intense-fg"> 1.78e-15</span>
        for particle collision
            m[110] =  5.18e+03 g    with
            m[118] =  7.20e+04 g

Writing file <span class="ansi-blue-intense-fg">data/data0022.hdf5</span>
Writing dump file <span class="ansi-blue-intense-fg">data/frame.dmp</span>
Execution time: <span class="ansi-blue-intense-fg">0:00:00</span>
</pre></div></div>
</div>
<p>Another file was written and the current time is now</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_restart</span><span class="o">.</span><span class="n">t</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100001.0
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="DustPy Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2_simple_customization.html" class="btn btn-neutral float-right" title="2. Simple Customization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Sebastian Stammler &amp; Til Birnstiel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>